<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Train Exchange</title>
    <style>
        #trainMarket {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .train {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }
    </style>
</head>
<body>

    <h1>Train Exchange</h1>
    <div id="trainMarket"></div>
    <div>
        <h2>Your Portfolio</h2>
        <ul id="portfolio"></ul>
        <p>Total Money: $<span id="totalMoney">10000</span></p>
    </div>

    <script>
        const trainMarketElement = document.getElementById('trainMarket');
        const portfolioElement = document.getElementById('portfolio');
        const totalMoneyElement = document.getElementById('totalMoney');

        let money = 10000;
        let portfolio = [];

        const trains = [
            { id: 622, image: 'https://i.imgur.com/9gI6buP.png', description: 'Train 622', basePrice: 2000 },
            { id: 61, image: 'https://i.imgur.com/ELbeAkI.png', description: 'Train 61', basePrice: 1500 },
            { id: 1038, image: 'https://i.imgur.com/Ll9Fa7s.png', description: 'Train 1038', basePrice: 2500 },
            { id: 1795, image: 'https://i.imgur.com/IPL5P9P.png', description: 'Train 1795', basePrice: 3000 },
            { id: 9999, image: 'https://i.imgur.com/XbzFNiC.png', description: 'Southern Express', basePrice: 5000 },
            { id: 1, image: 'https://i.imgur.com/U3EmWzR.png', description: 'SNCF B 82500 (BiBi) TER Poitou Charentes', basePrice: 6000 },
            { id: 2, image: 'https://i.imgur.com/FHJVLeg.png', description: 'SNCF B 83500', basePrice: 6800 },
        ];

        function generateRandomTrain() {
            const randomTrain = trains[Math.floor(Math.random() * trains.length)];
            const train = {
                id: randomTrain.id,
                image: randomTrain.image,
                description: randomTrain.description,
                price: Math.floor(randomTrain.basePrice * (Math.random() * 0.1 + 0.95)), // Cena o 5-10% vyšší
            };
            return train;
        }

        function displayTrains() {
            trainMarketElement.innerHTML = '';
            for (let i = 0; i < 3; i++) {
                const train = generateRandomTrain();
                const trainElement = document.createElement('div');
                trainElement.classList.add('train');
                trainElement.innerHTML = `
                    <img src="${train.image}" alt="${train.description}">
                    <p>${train.description}</p>
                    <p>Price: $${train.price}</p>
                    <button onclick="buyTrain(${train.id})">Buy</button>
                `;
                trainMarketElement.appendChild(trainElement);
            }
        }

        function buyTrain(trainId) {
            const selectedTrain = trains.find(train => train.id === trainId);
            if (money >= selectedTrain.basePrice) {
                money -= selectedTrain.basePrice;
                portfolio.push(selectedTrain);
                displayPortfolio();
                displayTrains();
                updateTotalMoney();
            } else {
                alert('Not enough money to buy this train!');
            }
        }

        function generateSaleOffer() {
            if (portfolio.length > 0) {
                const randomTrainIndex = Math.floor(Math.random() * portfolio.length);
                const train = portfolio[randomTrainIndex];
                const offerPrice = Math.floor(train.basePrice * (Math.random() * 0.1 + 1.05)); // Cena o 5-10% vyšší
                const companyName = generateRandomCompanyName();
                const confirmation = confirm(`Company ${companyName} wants to buy your train (${train.description}) for $${offerPrice}. Do you want to sell this train?`);
                if (confirmation) {
                    sellTrain(randomTrainIndex, offerPrice);
                }
            }
        }

        function generateRandomCompanyName() {
            const companies = ['EuroRail', 'SwiftTrans', 'TransCargo', 'RailStar', 'ExpressConnect', 'České Dráhy', 'Leo Expres', 'Student Agency', 'Deutsche Bahn', 'FlixTrain', 'Trenitalia', 'Trilexx', 'Waldbahn'];
            return companies[Math.floor(Math.random() * companies.length)];
        }

        function sellTrain(index, offerPrice) {
            money += offerPrice;
            portfolio.splice(index, 1);
            displayPortfolio();
            updateTotalMoney();
        }

        function displayPortfolio() {
            portfolioElement.innerHTML = '';
            portfolio.forEach((train, index) => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <img src="${train.image}" alt="${train.description}">
                    <p>${train.description}</p>
                    <p>Price: $${train.basePrice}</p>
                `;
                portfolioElement.appendChild(li);
            });
        }

        function updateTotalMoney() {
            totalMoneyElement.textContent = money;
        }

        // Spustit hru
        displayTrains();
        displayPortfolio();
        updateTotalMoney();

        // Každých 20 vteřin obnovit nabídky na trhu
        setInterval(() => {
            displayTrains();
        }, 20000);

        // Každou minutu generovat nabídku na prodej vlaku z hráčova portfolia
        setInterval(() => {
            generateSaleOffer();
        }, 60000);
    </script>

</body>
</html>

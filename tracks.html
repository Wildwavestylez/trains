<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Train Game</title>
    <!-- Přidání Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <!-- Přidání vlastního CSS (pokud chcete) -->
    <style>
        body { margin: 0; padding: 0; }
        #map { height: 75vh; }
        #player-info { padding: 10px; background-color: #f0f0f0; }
        #city-selector { margin: 10px; }
    </style>
</head>
<body>
    <!-- Informace pro hráče -->
    <div id="player-info">
        Dostupné finance: $2000 | Dostupný vlak: 5
    </div>
    <!-- Roletací nabídka s otázkou -->
    <div id="city-selector">
        <label for="city-select">Vyberte město:</label>
        <select id="city-select" onchange="changeCity()">
            <option value="Strakonice">Strakonice</option>
            <option value="Volyně">Volyně</option>
            <option value="Vimperk">Vimperk</option>
            <option value="Volary">Volary</option>
        </select>
    </div>
    <!-- Leaflet mapa -->
    <div id="map"></div>

    <!-- Přidání Leaflet JS a vlastního JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Inicializace Leaflet mapy
        var map = L.map('map').setView([49.2551575, 13.9163047], 13);

        // Přidání mapové podkladové vrstvy (například OpenStreetMap)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        // Přidání ikony vlaku na mapu
        var trainIcon = L.icon({
            iconUrl: 'https://i.imgur.com/neFFZgt.png',
            iconSize: [40, 40],
            iconAnchor: [20, 20],
            popupAnchor: [0, -20]
        });

        var trainMarker = L.marker([49.2551575, 13.9163047], { icon: trainIcon }).addTo(map);

        // Seznam tratí s jejich zastávkami
        var tracks = [
            {
                name: "Trať 198 Strakonice - Volary",
                color: "blue",
                stops: [
                    { name: "Strakonice", location: [49.2551575, 13.9163047] },
                         { name: "Radošovice", location: [49.2322158, 13.901812] },
                { name: "Přední Zborovice", location: [49.2183647, 13.8940200] },
                { name: "Strunkovice nad Volyňkou", location: [49.2100447, 13.8872928] },
                { name: "Hoštice", location: [49.1873397, 13.8930731] },
                { name: "Volyně", location: [49.1701164, 13.8928975] },
                { name: "Nišovice", location: [49.1502839, 13.9059867] },
                { name: "Malenice", location: [49.1237908, 13.8832197] },
                { name: "Lčovice", location: [49.1090089, 13.8666047] },
                { name: "Čkyně", location: [49.1111489, 13.8291083] },
                { name: "Bohumilice v Čechách, zastávka", location: [49.0975800, 13.8137817] },
                { name: "Bohumilice v Čechách", location: [49.0927086, 13.8010150] },
                { name: "Vimperk", location: [49.0555267, 13.7907544] },
                { name: "Vimperk, zastávka", location: [49.0487633, 13.7639522] },
                { name: "Lipka", location: [49.0202103, 13.7354764] },
                { name: "Kubova Huť", location: [48.9830017, 13.7747478] },
                { name: "Horní Vltavice", location: [48.9625625, 13.7746514] },
                { name: "Zátoň", location: [48.9509200, 13.8030072] },
                { name: "Zátoň - Boubín", location: [48.9515725, 13.8224831] },
                { name: "Lenora", location: [48.9283675, 13.7969542] },
                { name: "Lenora zastávka", location: [48.9233969, 13.8026581] },
                { name: "Soumarský Most", location: [48.9080047, 13.8287611] },
                    { name: "Volary", location: [48.9070969, 13.8833131] },
                ]
            },
            
            {
        name: "Trať 190 Plzeň - České Budějovice",
        color: "red",
        
         stops: [
                { name: "Plzeň hlavní nádraží", location: [49.7435456, 13.3880578] },
                { name: "Plzeň-Slovany", location: [49.7348519, 13.4078303] },
                { name: "Starý Plzenec", location: [49.6953125, 13.4781703] },
                { name: "Šťáhlavy", location: [49.6694031, 13.5035172] },
                { name: "Nezvěstice", location: [49.6423722, 13.5165967] },
                { name: "Zdemyslice", location: [49.6064719, 13.5170383] },
                { name: "Blovice", location: [49.5812264, 13.5314531] },
                { name: "Ždírec u Plzně", location: [49.5506783, 13.5739869] },
                { name: "Srby", location: [49.5246506, 13.5917739] },
                { name: "Nepomuk", location: [49.4975547, 13.6088542] },
                { name: "Mileč", location: [49.4618186, 13.6081772] },
                { name: "Nekvasovy", location: [49.4383658, 13.6105403] },
                { name: "Kovčín", location: [49.4135856, 13.6132697] },
                { name: "Pačejov", location: [49.3913308, 13.6205664] },
                { name: "Jetenovice", location: [49.3700714, 13.6656181] },
                { name: "Velký Bor", location: [49.3458594, 13.7009936] },
                { name: "Horažďovice předměstí", location: [49.3313714, 13.7388486] },
                { name: "Střelské Hoštice", location: [49.3051414, 13.7788925] },
                { name: "Dolní Poříčí", location: [49.2886125, 13.8008481] },
                { name: "Katovice", location: [49.2693519, 13.8235978] },
                { name: "Pracejovice", location: [49.2582358, 13.8489875] },
                { name: "Strakonice", location: [49.2551575, 13.9163047] },
                { name: "Modlešovice", location: [49.2565003, 13.9762058] },  
                { name: "Čejetice", location: [49.2515564, 14.0157986] },
                { name: "Sudoměř u Písku", location: [49.2494011, 14.0572156] },
                { name: "Ražice", location: [49.2446214, 14.1085939] },
                { name: "Heřmaň obec", location: [49.2364769, 14.1359625] },
                { name: "Skály", location: [49.2238389, 14.1645900] },
                { name: "Protivín", location: [49.2125053, 14.2119942] },
                { name: "Protivín zastávka", location: [49.1964417, 14.2224597] }, 
                
                { name: "Milenovice", location: [49.1726953, 14.2206258] },
                { name: "Číčenice", location: [49.1536025, 14.2215758] },
                { name: "Záblatíčko", location: [49.1249389, 14.2651444] },
                { name: "Zbudov", location: [49.0895767, 14.3268633] },
                { name: "Zliv", location: [49.0654831, 14.3617669] },
                { name: "Hluboká nad Vltavou", location: [49.0324019, 14.4202061] }, 
             { name: "České Budějovice severní zastávka", location: [48.9947853, 14.4793767] },
                { name: "České Budějovice", location: [48.9744872, 14.4886075] }, 
        ]
    }, 
            // Přidejte další tratě podle potřeby
        ];

         // Přidání tratí na mapu
        var trackPolylines = [];
        tracks.forEach(track => {
            var trackPolyline = L.polyline(track.stops.map(stop => stop.location), { color: track.color }).addTo(map);
            trackPolylines.push(trackPolyline);
        });

        // Přidání zastávek na mapu
        var stopMarkers = [];
        tracks.forEach(track => {
            track.stops.forEach(stop => {
                var stopMarker = L.marker(stop.location).addTo(map);
                stopMarker.bindPopup(stop.name);
                stopMarkers.push(stopMarker);
            });
        });

        // Finance hráče
        var playerMoney = 2000;

        // Aktualizace informací pro hráče
        function updatePlayerInfo() {
            document.getElementById("player-money").textContent = playerMoney;
        }

        // Funkce pro změnu města na mapě
        function changeCity() {
            var selectedCity = document.getElementById("city-select").value;
            var cityCoordinates;

            switch (selectedCity) {
                case "Strakonice":
                    cityCoordinates = [49.2551575, 13.9163047];
                    break;
                case "Volyně":
                    cityCoordinates = [49.1701164, 13.8928975];
                    break;
                case "Vimperk":
                    cityCoordinates = [49.0555267, 13.7907544];
                    break;
                case "Volary":
                    cityCoordinates = [48.9070969, 13.8833131];
                    break;
                default:
                    cityCoordinates = [49.2551575, 13.9163047]; // Defaultní hodnota
            }

            trainMarker.setLatLng(cityCoordinates); // Přesunutí markeru vlaku do vybraného města
            map.setView(cityCoordinates, 13);

            updateStopsVisibility(cityCoordinates);
        }

        // Funkce pro aktualizaci viditelnosti zastávek
        function updateStopsVisibility(cityCoordinates) {
            stopMarkers.forEach(marker => {
                var distance = marker.getLatLng().distanceTo(cityCoordinates);

                // Nastavte viditelnost podle vzdálenosti od vybraného města a stavu odemknutí
                if (distance <= 5000 || marker.stop.unlocked) { // Ukažte zastávky v poloměru 5 km nebo odemčené
                    marker.setOpacity(1);
                } else {
                    marker.setOpacity(0);
                }
            });
        }

        // Funkce pro odemknutí aktuálního města za herní dolary
        function unlockCurrentCity() {
            var selectedCity = document.getElementById("city-select").value;
            var selectedTrack = tracks.find(track => track.stops.some(stop => stop.name === selectedCity));

            if (selectedTrack) {
                var selectedStop = selectedTrack.stops.find(stop => stop.name === selectedCity);

                if (!selectedStop.unlocked && playerMoney >= 500) {
                    // Odečtěte 500 dolary a odemkněte zastávku
                    playerMoney -= 500;
                    selectedStop.unlocked = true;
                    updateStopsVisibility(trainMarker.getLatLng());
                    updatePlayerInfo();
                } else {
                    alert("Nemáte dostatek financí na odemknutí této zastávky.");
                }
            }
        }

        // Volání funkce pro aktualizaci informací pro hráče
        updatePlayerInfo();
    </script>
</body>
</html>
